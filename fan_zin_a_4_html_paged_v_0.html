<!--
 FanZin A4 — HTML Paged v0.3 (32 pages + UI + thumbnails + bleed/crop + Chapter 1)
 @version 0.3.0  | @date 2025‑09‑25 (Europe/Warsaw)
 @codename "Nawigator Pro"
 @changelog
  - Sidebar with page thumbnails (miniatury stron) — click to jump
  - 32 pages A4 with flexible per‑page/per‑block 1/2/3 column mixes
  - 3 mm bleed + visible crop marks; trim area + margin guides
  - Inserted provided PL text as CHAPTER 1 page (two/three‑column mix)
-->
<!doctype html>
<html lang="pl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta http-equiv="Content-Language" content="pl" />
<title>FanZin RPG — A4 (HTML Paged v0.3)</title>
<style>
  /* ====== Page Setup ====== */
  :root{
    --bleed: 3mm;              /* spady */
    --page-w: 210mm;           /* trim width */
    --page-h: 297mm;           /* trim height */
    --sheet-w: calc(var(--page-w) + 2*var(--bleed));
    --sheet-h: calc(var(--page-h) + 2*var(--bleed));
    --m-top: 15mm; --m-out: 17mm; --m-bot: 20mm; --m-in: 17mm; /* trim margins */
    --col-gap: 6mm;
    --accent: #06b6d4; /* cyjan */
    --ink: #111; --ink-soft:#444; --rule:#ddd; --paper:#fff; --thumb-bg:#f8f8f8;
    --font-body: "Literata", "Source Serif 4", "Noto Serif", "PT Serif", ui-serif, Georgia, serif;
    --font-ui: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Noto Sans", "DejaVu Sans", sans-serif;
    --ui-h: 56px; --sidebar-w: 184px;
  }

  @page {
    /* Uwaga: część przeglądarek ignoruje marks/bleed; renderujemy je ręcznie również na stronie */
    size: var(--sheet-w) var(--sheet-h);
    margin: 0;                  /* pełna kontrola z poziomu layoutu */
    bleed: var(--bleed);
    marks: crop;
  }

  /* ====== Global ====== */
  @media screen{ html,body{ background:#ffffff; margin:0; padding:0; } }
  body{ font-family: var(--font-body); font-size: 10.5pt; line-height: 1.42; font-kerning: normal; }
  *{ -webkit-font-smoothing: antialiased; text-rendering: optimizeLegibility; }
  h1,h2,h3{ font-family: var(--font-ui); margin: 0 0 3mm 0; line-height: 1.2; }
  h1.title{ font-size: 22pt; }
  h2{ font-size: 13pt; }
  h3{ font-size: 11pt; }
  p{ margin: 0 0 3.2mm 0; hyphens: auto; }
  .kicker{ text-transform: uppercase; letter-spacing: .08em; color:#666; font-size:9pt; }
  .muted{ color: var(--ink-soft); }
  .rule{ border-top: .3pt solid var(--rule); }
  .accent{ color: var(--accent); }

  /* ====== UI Toolbar ====== */
  #ui{ position: sticky; top: 0; z-index: 1000; background:#fff; border-bottom:1px solid #e6e6e6;
       font-family: var(--font-ui); height: var(--ui-h); display:flex; align-items:center; gap:12px; padding: 8px 12px; }
  #ui .btn{ border:1px solid #ddd; background:#fafafa; padding:6px 10px; border-radius:8px; cursor:pointer; font-size:14px; }
  #ui .btn:disabled{ opacity:.5; cursor:not-allowed; }
  #ui .stat{ font-size:14px; color:#333; }
  #ui input[type="number"]{ width:64px; padding:6px 8px; border:1px solid #ddd; border-radius:6px; }
  #ui .spacer{ flex:1 1 auto; }
  @media print{ #ui{ display:none; } }

  /* ====== Sidebar Thumbnails ====== */
  #sidebar{ position: fixed; top: var(--ui-h); left: 0; bottom: 0; width: var(--sidebar-w); background: var(--thumb-bg);
            border-right:1px solid #e6e6e6; overflow: auto; padding: 8px; }
  #thumbs .thumb{ padding:8px; margin-bottom:8px; background:#fff; border:1px solid #e6e6e6; border-radius:8px; cursor:pointer; }
  #thumbs .thumb.active{ outline:2px solid var(--accent); }
  .mini-wrap{ width: 120px; height: 172px; overflow: hidden; position: relative; margin: 0 auto 6px; }
  .mini-wrap .sheet{ transform: scale(.18); transform-origin: top left; box-shadow: none; border:0.5pt solid #e6e6e6; }
  .mini-wrap .trim::before{ display:none; } /* bez guides w miniaturze */
  .mini-meta{ text-align:center; font: 12px var(--font-ui); color:#333; }
  @media print{ #sidebar{ display:none; } }

  /* ====== Pages Container ====== */
  #pages{ margin-left: calc(var(--sidebar-w) + 12px); }

  /* ====== Sheet (bleed) + Trim + Guides + Crop marks ====== */
  .sheet{ position: relative; width: var(--sheet-w); height: var(--sheet-h); background: var(--paper); color: var(--ink);
          box-shadow: 0 6px 20px rgba(0,0,0,.12); margin: 16px auto; border: 0.5pt solid #e6e6e6; scroll-margin-top: calc(var(--ui-h) + 12px); }
  @media print{ .sheet{ box-shadow:none; margin:0 auto; border:none; } }

  /* crop marks (renderowane niezależnie od wsparcia @page marks) */
  .crop{ position:absolute; width:0; height:0; }
  .crop::before, .crop::after{ content:""; position:absolute; background:#000; }
  /* długość znaczników */
  :root{ --crop-l: 7mm; --crop-w: 0.25mm; }
  .crop.tl{ left: var(--bleed); top: var(--bleed); }
  .crop.tr{ right: var(--bleed); top: var(--bleed); }
  .crop.bl{ left: var(--bleed); bottom: var(--bleed); }
  .crop.br{ right: var(--bleed); bottom: var(--bleed); }
  /* poziome */
  .crop.tl::after, .crop.tr::after, .crop.bl::after, .crop.br::after{ height: var(--crop-w); width: var(--crop-l); }
  .crop.tl::after{ left: 0; top: calc(var(--m-top) - var(--crop-w)); transform: translateX(calc(-1 * var(--crop-l))); }
  .crop.tr::after{ right: 0; top: calc(var(--m-top) - var(--crop-w)); }
  .crop.bl::after{ left: 0; bottom: calc(var(--m-bot) - var(--crop-w)); transform: translateX(calc(-1 * var(--crop-l))); }
  .crop.br::after{ right: 0; bottom: calc(var(--m-bot) - var(--crop-w)); }
  /* pionowe */
  .crop.tl::before, .crop.tr::before, .crop.bl::before, .crop.br::before{ width: var(--crop-w); height: var(--crop-l); }
  .crop.tl::before{ top: 0; left: calc(var(--m-in) - var(--crop-w)); transform: translateY(calc(-1 * var(--crop-l))); }
  .crop.tr::before{ top: 0; right: calc(var(--m-out) - var(--crop-w)); transform: translateY(calc(-1 * var(--crop-l))); }
  .crop.bl::before{ bottom: 0; left: calc(var(--m-in) - var(--crop-w)); }
  .crop.br::before{ bottom: 0; right: calc(var(--m-out) - var(--crop-w)); }

  /* Trim box */
  .trim{ position: absolute; left: var(--bleed); top: var(--bleed); width: var(--page-w); height: var(--page-h); background: transparent; }
  /* Margin guides inside trim */
  .trim::before{ content:""; position:absolute; left: var(--m-in); right: var(--m-out); top: var(--m-top); bottom: var(--m-bot);
                 border:0.4pt dashed #bdbdbd; pointer-events:none; }

  /* ====== Running header source via string-set ====== */
  .section-title{ string-set: section content(text); }

  /* ====== Content Blocks (inside .trim) ====== */
  .head{ padding: 10mm 14mm 6mm 14mm; border-bottom: .3pt solid var(--rule); }
  .cols{ padding: 6mm 14mm 0 14mm; hyphens: auto; }
  .cols-1{ column-count: 1; }
  .cols-2{ column-count: 2; column-gap: var(--col-gap); }
  .cols-3{ column-count: 3; column-gap: var(--col-gap); }
  .cols p, .cols li, .cols figure, .cols h2, .cols h3{ break-inside: avoid-column; }
  .span-all{ column-span: all; }
  .split{ padding-bottom: 6mm; }
  .foot{ padding: 4mm 14mm 6mm 14mm; border-top: .3pt solid var(--rule); font-size: 9pt; color:#666; display:flex; justify-content:space-between; }

  /* Figures */
  figure{ margin: 0 0 4mm 0; }
  .ph{ width: 100%; background: linear-gradient(135deg,#e8f7fb,#f5e8ff); border:0.3pt solid #dcdcdc; }
  .ph.h30{ height: 30mm; } .ph.h40{ height: 40mm; } .ph.h50{ height: 50mm; } .ph.h60{ height: 60mm; }
  figure figcaption{ font-size: 9pt; color:#666; margin-top: 1.6mm; }

  /* Utilities */
  .mb2{ margin-bottom: 2mm; } .mb4{ margin-bottom: 4mm; } .mb6{ margin-bottom: 6mm; }
</style>
<script src="https://unpkg.com/pagedjs/dist/paged.polyfill.js"></script>
</head>
<body>

  <!-- ======= UI Toolbar ======= -->
  <div id="ui">
    <button class="btn" id="firstBtn">⏮︎ Pierwsza</button>
    <button class="btn" id="prevBtn">◀︎ Poprzednia</button>
    <div class="stat">Strona <span id="cur">1</span> / <span id="tot">32</span></div>
    <input type="number" id="goto" min="1" max="32" value="1" />
    <button class="btn" id="goBtn">Idź</button>
    <button class="btn" id="nextBtn">Następna ▶︎</button>
    <button class="btn" id="lastBtn">Ostatnia ⏭︎</button>
    <div class="spacer"></div>
    <div class="stat muted">A4 z 3 mm spadami · układy 1/2/3 kolumn, mieszane na stronie</div>
  </div>

  <!-- ======= Sidebar Thumbnails ======= -->
  <aside id="sidebar"><div id="thumbs"></div></aside>

  <!-- ======= Pages Container ======= -->
  <div id="pages"></div>

<script>
(function(){
  const TOTAL = 32;
  const pagesEl = document.getElementById('pages');
  const curEl = document.getElementById('cur');
  const totEl = document.getElementById('tot');
  const gotoEl = document.getElementById('goto');
  const prevBtn = document.getElementById('prevBtn');
  const nextBtn = document.getElementById('nextBtn');
  const firstBtn = document.getElementById('firstBtn');
  const lastBtn = document.getElementById('lastBtn');
  const goBtn = document.getElementById('goBtn');
  const thumbsEl = document.getElementById('thumbs');

  totEl.textContent = String(TOTAL);

  /* Patterns of column blocks per page (flexible mixes) */
  const patterns = [
    ['2'], ['3'], ['1'], ['2','3'], ['3','2'], ['1','2'], ['2','1','3'], ['3','1'], ['2','2','3'], ['3','3','1']
  ];

  function loremSentence(){
    const bits = [
      'Lorem ipsum', 'dolor sit amet', 'konsekwentny nerdowski ton', 'mechanika stołu', 'wielokolumnowy layout', 'mikrotypografia', 'polskie dzielenie wyrazów', 'światotwórstwo', 'bestiariusz', 'przygoda jednostrzałowa', 'test umiejętności', 'MG uśmiecha się złowieszczo', 'kości toczą się po stole', 'patch edycji', 'klarowny interfejs zasad'
    ];
    const len = 6 + Math.floor(Math.random()*8);
    let out = [];
    for(let i=0;i<len;i++) out.push(bits[Math.floor(Math.random()*bits.length)]);
    let s = out.join(' ') + '.';
    s = s.charAt(0).toUpperCase() + s.slice(1);
    return s;
  }
  function loremPara(){
    const n = 3 + Math.floor(Math.random()*5);
    let p = [];
    for(let i=0;i<n;i++) p.push(loremSentence());
    return p.join(' ');
  }
  function fig(height){
    const h = height || ['h30','h40','h50','h60'][Math.floor(Math.random()*4)];
    const spanAll = Math.random() < 0.35; // część pełnej szerokości
    const f = document.createElement('figure');
    if(spanAll) f.classList.add('span-all');
    const img = document.createElement('div'); img.className = 'ph ' + h;
    const cap = document.createElement('figcaption'); cap.textContent = spanAll ? 'Ilustracja: placeholder (pełna szerokość)' : 'Ilustracja: placeholder';
    f.appendChild(img); f.appendChild(cap); return f;
  }
  function para(text){ const p = document.createElement('p'); p.textContent = text || loremPara(); return p; }

  function makeColsBlock(colsClass){
    const b = document.createElement('div'); b.className = 'cols ' + ('cols-' + colsClass) + ' split';
    const parts = 6 + Math.floor(Math.random()*10);
    for(let i=0;i<parts;i++){
      if(i>0 && i%3===0){ b.appendChild(fig()); }
      b.appendChild(para());
    }
    if(Math.random()<0.25) b.appendChild(fig('h40'));
    return b;
  }

  function makeTrim(){
    const t = document.createElement('div'); t.className = 'trim';
    /* crop marks */
    for(const c of ['tl','tr','bl','br']){
      const m = document.createElement('div'); m.className = 'crop '+c; t.appendChild(m);
    }
    return t;
  }

  function pageSkeleton(titleText){
    const sheet = document.createElement('section'); sheet.className = 'sheet';
    const trim = makeTrim(); sheet.appendChild(trim);

    const head = document.createElement('header'); head.className = 'head';
    head.innerHTML = '<div class="kicker">FanZin RPG · Numer 0</div>'+
                     '<h1 class="title section-title">'+(titleText||'Artykuł demonstracyjny')+'</h1>';
    trim.appendChild(head);
    return {sheet, trim};
  }

  function chapterOnePage(){
    const {sheet, trim} = pageSkeleton('ROZDZIAŁ PIERWSZY — TWORZENIE POSTACI');
    /* Two columns intro */
    const c2 = document.createElement('div'); c2.className = 'cols cols-2 split';
    c2.appendChild(para('Gdy grasz fabularnie, wcielasz się w inną osobę — postać, którą sam tworzysz. GURPS pozwala dokładnie zdecydować, jakim bohaterem chcesz zostać. Górnik asteroid? Czarodziej? Zawodowy podróżnik w czasie? Możesz wzorować się na fikcyjnym herosie lub heroinie, albo zbudować swoje nowe „ja” od podstaw. Kiedy już wiesz, jaką rolę chcesz odegrać, czas tchnąć życie w tę postać!'));
    c2.appendChild(para('MG (Mistrz Gry — osoba prowadząca rozgrywkę, ang. GM) przydzieli ci pulę punktów postaci, za które „kupujesz” swoje zdolności. Na przykład: im większą chcesz mieć siłę, tym więcej punktów to kosztuje. Możesz też nabywać korzystne cechy społeczne, takie jak majątek, oraz zalety — specjalne zdolności opisane w rozdziale 2.'));
    c2.appendChild(para('Jeśli chcesz mieć więcej zdolności niż pozwala twój budżet ustalony przez MG, możesz zdobyć dodatkowe punkty, akceptując cechy poniżej przeciętnej (np. siłę, wygląd, majątek, status) albo biorąc wady — konkretne ograniczenia, takie jak słaby wzrok czy lęk wysokości (zob. rozdział 3).'));
    c2.appendChild(para('Bardziej doświadczeni gracze mogą dostrajać te cechy za pomocą ulepszeń i ograniczeń; zob. s. 101–117. Takie modyfikatory podnoszą lub obniżają bazowy koszt punktowy zmodyfikowanej cechy.'));
    c2.appendChild(para('Zacznij od karty postaci (zob. s. 13) i wypełniaj ją w miarę postępów, pilnując wydawanych punktów. Na każdym etapie zamieściliśmy przykłady, które ilustrują proces.'));
    trim.appendChild(c2);

    /* Section break: full-span heading */
    const cspan = document.createElement('div'); cspan.className = 'cols cols-2 split';
    const h2 = document.createElement('h2'); h2.className = 'span-all'; h2.textContent = 'PUNKTY POSTACI'; cspan.appendChild(h2);
    cspan.appendChild(para('Punkty postaci to „waluta” tworzenia bohatera. Wszystko, co zwiększa twoje możliwości, kosztuje punkty: musisz wydać liczbę punktów równą cenie danej zdolności, aby dodać ją do karty i używać w grze. Wszystko, co obniża twoje możliwości, ma koszt ujemny — czyli oddaje ci punkty.'));
    cspan.appendChild(para('Przykład: jeśli zaczynasz ze 125 punktami, kupisz 75 punktów zalet, a weźmiesz −15 punktów wad, zostanie ci 125 − 75 + 15 = 65 punktów.'));
    trim.appendChild(cspan);

    /* Three columns subsection */
    const c3 = document.createElement('div'); c3.className = 'cols cols-3 split';
    c3.appendChild(para('Punkty początkowe')); // lead
    c3.appendChild(para('To MG decyduje, z iloma punktami zaczną PG (PC) — bohaterowie graczy. Zależy to od tego, jak sprawne mają być postaci, i może się wahać od poniżej 25 punktów (małe dzieci) do 1000 punktów lub więcej (istoty na poziomie boskim), przy czym 100–200 punktów to wartość typowa dla zawodowych poszukiwaczy przygód.'));
    c3.appendChild(para('Ten poziom startowy bywa nazywany poziomem mocy kampanii (zob. Power Level, s. 487). To nie to samo co stawka kampanii! Bohaterowie, których zdolności pozwalają pokonać nawet najtwardszych przeciwników w optymistycznej fantasy, mogą mierzyć się ze śmiertelnym zagrożeniem w mrocznym scenariuszu grozy.'));
    c3.appendChild(para('W większości kampanii wszystkie PG zaczynają na tym samym poziomie mocy — to proste i sprawiedliwe. Jednak tak jak w prawdziwym życiu ludzie nie są równie utalentowani, tak i w fikcji często zdarza się postać wyraźnie przewyższająca innych. Jeśli wszyscy się zgadzają, część graczy może prowadzić „głównych protagonistów”…'));
    /* Image across all columns */
    const figAll = document.createElement('figure'); figAll.className = 'span-all mb4';
    const img = document.createElement('div'); img.className = 'ph h40';
    const cap = document.createElement('figcaption'); cap.textContent = 'Schemat: przepływ punktów postaci';
    figAll.appendChild(img); figAll.appendChild(cap); c3.appendChild(figAll);
    trim.appendChild(c3);

    const foot = document.createElement('footer'); foot.className = 'foot rule'; foot.innerHTML = '<span>Rozdział 1 — Tworzenie postaci</span><span></span>';
    trim.appendChild(foot);

    return sheet;
  }

  function genericPage(i){
    const {sheet, trim} = pageSkeleton('Artykuł demonstracyjny · Strona '+(i+1));
    const pat = patterns[i % patterns.length];
    for(const c of pat){ trim.appendChild(makeColsBlock(c)); }
    const foot = document.createElement('footer'); foot.className = 'foot rule'; foot.innerHTML = '<span>FanZin — Demo</span><span></span>';
    trim.appendChild(foot);
    return sheet;
  }

  // Generate pages
  for(let i=0;i<TOTAL;i++){
    const page = (i===0) ? chapterOnePage() : genericPage(i);
    page.dataset.index = String(i);
    pagesEl.appendChild(page);
  }

  const pages = Array.from(document.querySelectorAll('.sheet'));

  // Build thumbnails (clone pages, scale down)
  pages.forEach((p, idx)=>{
    const wrap = document.createElement('div'); wrap.className = 'thumb'; wrap.dataset.index = String(idx);
    const mini = document.createElement('div'); mini.className = 'mini-wrap';
    const clone = p.cloneNode(true);
    mini.appendChild(clone);
    wrap.appendChild(mini);
    const meta = document.createElement('div'); meta.className = 'mini-meta'; meta.textContent = 'Strona ' + (idx+1);
    wrap.appendChild(meta);
    wrap.addEventListener('click', ()=> snapTo(idx));
    thumbsEl.appendChild(wrap);
  });

  let cur = 0;
  function setActiveThumb(){
    document.querySelectorAll('.thumb.active').forEach(e=> e.classList.remove('active'));
    const t = thumbsEl.querySelector('.thumb[data-index="'+cur+'"]'); if(t) t.classList.add('active');
  }

  function snapTo(idx){
    cur = Math.max(0, Math.min(TOTAL-1, idx));
    pages[cur].scrollIntoView({behavior:'smooth', block:'start'});
    curEl.textContent = String(cur+1);
    gotoEl.value = String(cur+1);
    prevBtn.disabled = (cur===0); firstBtn.disabled = (cur===0);
    nextBtn.disabled = (cur===TOTAL-1); lastBtn.disabled = (cur===TOTAL-1);
    setActiveThumb();
  }

  // UI events
  prevBtn.addEventListener('click', ()=> snapTo(cur-1));
  nextBtn.addEventListener('click', ()=> snapTo(cur+1));
  firstBtn.addEventListener('click', ()=> snapTo(0));
  lastBtn.addEventListener('click', ()=> snapTo(TOTAL-1));
  goBtn.addEventListener('click', ()=> { const v = parseInt(gotoEl.value,10)||1; snapTo(v-1); });
  gotoEl.addEventListener('keydown', (e)=>{ if(e.key==='Enter'){ const v=parseInt(gotoEl.value,10)||1; snapTo(v-1);} });

  // Keyboard shortcuts
  window.addEventListener('keydown', (e)=>{
    if(e.target===gotoEl) return;
    if(e.key==='ArrowRight' || e.key==='PageDown') snapTo(cur+1);
    if(e.key==='ArrowLeft'  || e.key==='PageUp')   snapTo(cur-1);
    if(e.key==='Home') snapTo(0);
    if(e.key==='End')  snapTo(TOTAL-1);
  });

  // Track scroll position to update page number
  const obs = new IntersectionObserver((entries)=>{
    let topMost = null; let topY = Infinity;
    for(const e of entries){ if(e.isIntersecting){ const r = e.target.getBoundingClientRect(); if(r.top >= 0 && r.top < topY){ topY = r.top; topMost = e.target; } } }
    if(topMost){
      const idx = pages.indexOf(topMost);
      if(idx>=0){ cur = idx; curEl.textContent = String(cur+1); gotoEl.value = String(cur+1); setActiveThumb();
        prevBtn.disabled = (cur===0); firstBtn.disabled = (cur===0);
        nextBtn.disabled = (cur===TOTAL-1); lastBtn.disabled = (cur===TOTAL-1);
      }
    }
  }, { root: null, rootMargin: '0px', threshold: [0.6] });
  pages.forEach(p=> obs.observe(p));

  // Start at page 1
  snapTo(0);
})();
</script>
</body>
</html>
